{"version":3,"file":"pages-tracking-detail.BluQQFio.js","sources":["../../../../src/pages/tracking/detail.vue"],"sourcesContent":["<template>\n  <!-- ========================= 顶部蓝色区域(用户信息) =========================== -->\n  <SafeTopContainer>\n    <view\n      class=\"flex items-center\"\n      style=\"\n        width: 100%;\n        height: 88rpx;\n        background-color: #235597;\n        padding-left: 32rpx;\n      \"\n    >\n      <wd-icon\n        name=\"thin-arrow-left\"\n        size=\"18px\"\n        color=\"#FFFFFF\"\n        @click=\"handleBackPrevSetup\"\n      ></wd-icon>\n    </view>\n    <view class=\"top-blue-section\">\n      <view class=\"top-info\">\n        <image :src=\"userInfo?.avatar\" class=\"avatar\" mode=\"widthFix\" />\n        <view class=\"welcome-text\">\n          <text>Welcome</text>\n          <text class=\"name\"> {{ userInfo?.nickname }}</text>\n        </view>\n      </view>\n      <view class=\"message-icon\" @click=\"handleClickMessage\">\n        <image :src=\"img_messageIcon\" class=\"msg-icon\" mode=\"widthFix\" />\n        <view class=\"badge\">1</view>\n      </view>\n    </view>\n  </SafeTopContainer>\n  <!-- =========================== 搜索栏区域 =================================== -->\n  <view class=\"top_order_card\">\n    <!-- ----------------------- 小卡片 -------------------------  -->\n    <view class=\"item-card\">\n      <view class=\"item-icon\">\n        <image\n          :src=\"orderDataSource?.cate_image\"\n          mode=\"widthFix\"\n          style=\"width: 100%\"\n        />\n      </view>\n      <view class=\"item-content\">\n        <!-- <text\n          v-if=\"orderDataSource?.method == 2 || orderDataSource?.method == 4\"\n        >\n          \n        </text> -->\n        <view class=\"item-cate-name\">\n          {{ orderDataSource?.cate_name }}\n        </view>\n        <view class=\"item-title\">\n          <view class=\"desc_icon\">\n            <image\n              :src=\"getIcon(orderDataSource)\"\n              mode=\"widthFix\"\n              style=\"width: 100%\"\n            />\n          </view>\n          <view class=\"item-title-text\">\n            <text\n              v-if=\"\n                orderDataSource?.method == 1 || orderDataSource?.method == 3\n              \"\n            >\n              {{ orderDataSource?.from }} -> {{ orderDataSource?.to }}\n            </text>\n            <text\n              v-if=\"\n                orderDataSource?.method == 2 || orderDataSource?.method == 4\n              \"\n            >\n              {{ orderDataSource?.title }}\n            </text>\n          </view>\n        </view>\n        <!-- <view class=\"item-desc\">\n          <view class=\"desc_icon\">\n            <image\n              :src=\"getIcon(orderDataSource)\"\n              mode=\"widthFix\"\n              style=\"width: 100%\"\n            />\n          </view>\n          {{ orderDataSource?.description }}\n        </view> -->\n        <view class=\"item-price\">\n          <view class=\"price_icon\">\n            <image\n              :src=\"\n                orderDataSource?.methodtype == 1 ? oArrowRight : rArrowRight\n              \"\n              mode=\"widthFix\"\n              style=\"width: 100%\"\n            />\n          </view>\n          <!-- ${{ orderDataSource?.price }} -->\n        </view>\n      </view>\n    </view>\n  </view>\n  <view class=\"content-wrapper\" :style=\"{ height: contentHeight + 'px' }\">\n    <!-- =========================== 接单用户卡片列表 =================================== -->\n    <MatchUserList\n      v-if=\"processStep == 1 && orderDataSource?.id\"\n      :orderId=\"orderDataSource?.id\"\n      @choose=\"handleChooseUser\"\n    />\n    <!-- =========================== 接单用户详情 =================================== -->\n    <MatchUserDetail\n      v-else-if=\"processStep == 2 && chooseUser\"\n      :dataSource=\"chooseUser\"\n      @accept=\"handleAcceptUser\"\n      @decline=\"handleDeclineUser\"\n    />\n    <!-- =========================== 接单用户请求对话 =============================== -->\n    <Step3\n      v-else-if=\"processStep == 3 && chooseUser\"\n      :dataSource=\"chooseUser\"\n      @click=\"handleClickOrderStatus\"\n    />\n    <!-- =========================== 订单状态列表 =================================== -->\n    <Step4 v-else-if=\"processStep == 4\" @confirm=\"handleConfirmOrder\" />\n    <!-- =========================== 订单评价 =================================== -->\n    <Step5 v-else-if=\"processStep == 5\" @submit=\"handleSubmit\" />\n  </view>\n  <CustomTabbar />\n</template>\n\n<script setup>\nimport { ref } from \"vue\"\nimport CustomTabbar from \"@/components/CustomTabbar.vue\"\n// 导入所需的步骤组件\nimport MatchUserList from \"@/pages/tracking/components/MatchUserList.vue\"\nimport MatchUserDetail from \"@/pages/tracking/components/MatchUserDetail.vue\"\nimport Step3 from \"@/pages/tracking/components/03_orderStep.vue\"\nimport Step4 from \"@/pages/tracking/components/04_orderStep.vue\"\nimport Step5 from \"@/pages/tracking/components/05_orderStep.vue\"\n\n// 导入所需图片\n// 搜索框的图标\nimport img_messageIcon from \"@/static/home/messageIcon.png\"\nimport img_dollor_money from \"@/static/explore/general/dollor_money.png\"\n\nimport img_request_locate from \"@/static/explore/general/request_locate.png\"\n\nimport img_request_delivery from \"@/static/explore/requests/request_delivery.png\"\nimport { indexOrderDetail } from \"@/api/totalApi\"\nimport img_request_checked from \"@/static/explore/general/request_checked.png\"\nimport img_offering_locate from \"@/static/explore/general/offering_locate.png\"\nimport img_offering_checked from \"@/static/explore/general/offering_checked.png\"\n\nimport oArrowRight from \"@/static/common/o-arrow-right.svg\"\nimport rArrowRight from \"@/static/common/r-arrow-right.svg\"\n\nimport SafeTopContainer from \"@/components/SafeTopContainer.vue\"\nimport { useNavigate } from \"@/hooks/useNavigate\"\n\nconst processStep = ref(1)\n\nconst chooseUser = ref({})\n\nconst orderDataSource = ref({})\n\nconst userStore = useUserStore()\nconst userInfo = computed(() => userStore.userInfo)\n\nconst { screenHeight, screenWidth } = uni.getSystemInfoSync()\nconst contentHeight = ref(screenHeight)\n\nconst handleChooseUser = (data) => {\n  processStep.value = 2\n  chooseUser.value = data\n}\n\nconst handleAcceptUser = async (data) => {\n  const r = await indexSetMatch({\n    id: data.id,\n    status: 2,\n  })\n  if (r.code == 200) {\n    processStep.value = 3\n  }\n}\n\nconst handleDeclineUser = (data) => {\n  processStep.value = 1\n}\n\nconst handleClickOrderStatus = (data) => {\n  processStep.value = 4\n}\n\nconst handleConfirmOrder = (data) => {\n  processStep.value = 5\n}\n\nconst handleSubmit = (data) => {\n  useSwitchTab(\"/pages/home/index\")\n}\n\nconst handleClickMessage = () => {\n  useNavigate(\"/pages/communication/index\")\n}\n\nconst getIcon = (item) => {\n  if (!item) {\n    return null\n  }\n  // 提供\n  if (item.methodtype == 2) {\n    if (item.method == 2 || item.method == 4) {\n      return img_request_locate\n    } else {\n      return img_request_checked\n    }\n  }\n  // 需求\n  else if (item.methodtype == 1) {\n    if (item.method == 1 || item.method == 3) {\n      return img_offering_locate\n    } else {\n      return img_offering_checked\n    }\n  }\n}\n\nconst handleBackPrevSetup = () => {\n  const a = processStep.value - 1\n  if (a < 1) {\n    useNavigateBack()\n  } else {\n    processStep.value = a\n  }\n}\n\nonLoad(async (options) => {\n  const r = await indexOrderDetail({ id: options.id })\n  orderDataSource.value = r.data\n})\n\nconst { ctx } = getCurrentInstance()\n\nonMounted(() => {\n  let a = 0\n\n  nextTick(() => {\n    uni\n      .createSelectorQuery()\n      .in(ctx)\n      .select(\".top-blue-section\")\n      .boundingClientRect(function (rect) {\n        a += rect.height\n      })\n      .exec()\n\n    uni\n      .createSelectorQuery()\n      .in(ctx)\n      .select(\".top_order_card\")\n      .boundingClientRect(function (rect) {\n        a += rect.height\n      })\n      .exec()\n    contentHeight.value -= a\n  })\n})\n</script>\n\n<style lang=\"scss\" scoped>\n// 页面容器（必需）\n.container {\n  width: 100%;\n  min-height: 100vh;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n// 页面容器（必需）\n.content {\n  background-color: #f4f6fe;\n  width: 100%;\n  min-height: 100vh;\n  padding-bottom: 100px;\n  box-sizing: border-box;\n}\n\n// ======================================= 顶部蓝色区域 =======================================\n.top-blue-section {\n  width: 100%;\n  padding: 16px;\n  box-sizing: border-box;\n\n  background-color: #235597;\n  color: white;\n\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n\n  // 左侧的用户信息\n  .top-info {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    align-items: center;\n\n    .avatar {\n      width: 80px;\n      height: 80px;\n      border-radius: 50%;\n    }\n\n    .welcome-text {\n      margin-left: 20px;\n\n      text {\n        display: block;\n        font-weight: 700;\n        margin-bottom: 6px;\n      }\n\n      .name {\n        font-weight: 500;\n      }\n    }\n  }\n\n  // 右侧的消息图标\n  .message-icon {\n    position: relative;\n\n    .msg-icon {\n      width: 30px;\n      height: 28px;\n      border-radius: 4px;\n    }\n\n    .badge {\n      position: absolute;\n      top: -6px;\n      right: -6px;\n\n      display: flex;\n      justify-content: center;\n      align-items: center;\n\n      width: 16px;\n      height: 16px;\n\n      background-color: #ff4444;\n      color: white;\n      font-size: 14px;\n\n      border-radius: 50%;\n      border: 1px solid #fff;\n    }\n  }\n}\n\n// ======================================= 搜索栏区域 =========================================\n.top_order_card {\n  width: 100%;\n  height: auto;\n  padding: 18px;\n  box-sizing: border-box;\n\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  background-color: #235597;\n\n  /* 列表项卡片（单个卡片）样式 */\n  .item-card {\n    // margin: 12px; // 为适配上面搜索框，把顶部 外边距 都去掉了\n    // padding: 12px;\n    width: 100%;\n    height: auto;\n    padding: 12px;\n\n    box-sizing: border-box;\n    background-color: white;\n    border-radius: 8px;\n    display: flex;\n    align-items: center;\n  }\n\n  .item-icon {\n    width: 60px;\n    height: 60px;\n    padding: 10px;\n    margin-right: 12px;\n    // box-sizing: border-box;\n\n    background-color: #f0edea;\n    border-radius: 50%;\n\n    display: flex;\n    justify-content: center; // 水平居中\n    align-items: center; // 垂直居中\n    overflow: hidden;\n  }\n\n  .item-content {\n    flex: 1;\n    height: 100%;\n  }\n\n  .item-cate-name {\n    font-size: 32rpx;\n    font-weight: bold;\n  }\n\n  .item-title {\n    font-size: 24rpx;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    margin-top: 20rpx;\n\n    .item-title-text {\n      width: calc(100% - 64rpx);\n      display: flex;\n      align-items: center;\n      margin-left: 12rpx;\n    }\n  }\n\n  .item-desc {\n    font-size: 14px;\n    color: #666;\n    margin-bottom: 4px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n  }\n\n  .desc_icon {\n    width: 20rpx;\n    height: 20rpx;\n    margin-right: 4px;\n    border-radius: 50%;\n\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .item-price {\n    font-size: 14px;\n    font-weight: normal;\n    line-height: normal;\n    letter-spacing: normal;\n    color: #9a9a9a;\n    margin-top: 14rpx;\n\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n\n    .price_icon {\n      width: 16px;\n      height: 16px;\n      margin-right: 4px;\n      border-radius: 50%;\n\n      display: flex;\n      justify-content: center; // 水平居中\n      align-items: center; // 垂直居中\n      // overflow: hidden;\n    }\n  }\n\n  .item-arrow {\n    color: #0099cc;\n    font-size: 16px;\n\n    .arow_icon {\n      width: 16px;\n      height: 16px;\n      margin-right: 4px;\n      border-radius: 50%;\n\n      display: flex;\n      justify-content: center; // 水平居中\n      align-items: center; // 垂直居中\n      // overflow: hidden;\n    }\n  }\n}\n\n.content-wrapper {\n  padding: 40rpx;\n  box-sizing: border-box;\n  background: #f4f6ff;\n}\n</style>\n"],"names":["processStep","ref","chooseUser","orderDataSource","userStore","useUserStore","userInfo","computed","screenHeight","screenWidth","uni.getSystemInfoSync","contentHeight","handleChooseUser","data","value","handleAcceptUser","__async","this","indexSetMatch","id","status","code","handleDeclineUser","handleClickOrderStatus","handleConfirmOrder","handleSubmit","useSwitchTab","handleClickMessage","useNavigate","handleBackPrevSetup","a","useNavigateBack","onLoad","options","r","indexOrderDetail","ctx","getCurrentInstance","onMounted","nextTick","uni\n      .createSelectorQuery","in","select","boundingClientRect","rect","height","exec","item","methodtype","method","img_request_locate","img_request_checked","img_offering_locate","img_offering_checked"],"mappings":"4tCAgKA,MAAMA,EAAcC,EAAI,GAElBC,EAAaD,EAAI,CAAA,GAEjBE,EAAkBF,EAAI,CAAA,GAEtBG,EAAYC,IACZC,EAAWC,EAAS,IAAMH,EAAUE,WAEpCE,aAAEA,EAAAC,YAAcA,GAAgBC,IAChCC,GAAgBV,EAAIO,GAEpBI,GAAoBC,IACxBb,EAAYc,MAAQ,EACpBZ,EAAWY,MAAQD,GAGfE,GAA0BF,GAASG,EAAAC,KAAA,KAAA,YAKzB,YAJEC,EAAc,CAC5BC,GAAIN,EAAKM,GACTC,OAAQ,KAEJC,OACJrB,EAAYc,MAAQ,EAExB,GAEMQ,GAAqBT,IACzBb,EAAYc,MAAQ,GAGhBS,GAA0BV,IAC9Bb,EAAYc,MAAQ,GAGhBU,GAAsBX,IAC1Bb,EAAYc,MAAQ,GAGhBW,GAAgBZ,IACpBa,EAAa,sBAGTC,GAAqB,KACzBC,EAAY,+BAyBRC,GAAsB,KAC1B,MAAMC,EAAI9B,EAAYc,MAAQ,EAC1BgB,EAAI,EACNC,IAEA/B,EAAYc,MAAQgB,GAIxBE,EAAcC,GAAYjB,EAAAC,KAAA,KAAA,YACxB,MAAMiB,QAAUC,EAAiB,CAAEhB,GAAIc,EAAQd,KAC/ChB,EAAgBW,MAAQoB,EAAErB,IAC5B,IAEA,MAAMuB,IAAEA,IAAQC,WAEhBC,EAAU,KACR,IAAIR,EAAI,EAERS,EAAS,KACPC,IAEGC,GAAGL,IACHM,OAAO,qBACPC,mBAAmB,SAAUC,GAC5Bd,GAAKc,EAAKC,MAClB,GACOC,OAEHN,IAEGC,GAAGL,IACHM,OAAO,mBACPC,mBAAmB,SAAUC,GAC5Bd,GAAKc,EAAKC,MAClB,GACOC,OACHnC,GAAcG,OAASgB,o3CA3DViB,UACVA,EAIkB,GAAnBA,EAAKC,WACY,GAAfD,EAAKE,QAA8B,GAAfF,EAAKE,OACpBC,EAEAC,EAIiB,GAAnBJ,EAAKC,WACO,GAAfD,EAAKE,QAA8B,GAAfF,EAAKE,OACpBG,EAEAC,OANb,EATW,6DAFK,IAACN"}