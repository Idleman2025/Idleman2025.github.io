var e=Object.defineProperty,o=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(o,t,a)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a,u=(e,o)=>{for(var t in o||(o={}))l.call(o,t)&&n(e,t,o[t]);if(a)for(var t of a(o))s.call(o,t)&&n(e,t,o[t]);return e},i=(e,a)=>o(e,t(a));import{E as r,H as d,G as c,I as p,al as m,aB as v,J as f,aN as w,r as y,L as b,q as _,O as g,a2 as h,aO as $,c as x,R as k,o as C,w as K,d as O,X as P,a3 as S,i as T,v as z,F as I,z as V,D as j,f as E,g as N,x as Q,C as F,S as H,az as L,a0 as B,_ as G,K as M,aP as U,Q as A,a as D,b as q,aQ as J,e as R,y as X}from"./index-CxyijM87.js";import{u as Y}from"./useParent.B1gYIzoG.js";import{u as W}from"./useChildren.En5eoaK3.js";const Z="__QUEUE_KEY__";let ee=[];const oe=Symbol("wd-drop-menu"),te=i(u({},p),{zIndex:r(12),direction:c("down"),modal:d(!0),closeOnClickModal:d(!0),duration:r(200)}),ae=i(u({},p),{customTitle:c(""),customIcon:c(""),modelValue:[String,Number],options:v(),disabled:d(!1),iconName:c("check"),title:String,icon:c("arrow-down"),iconSize:m,beforeToggle:Function,valueKey:c("value"),labelKey:c("label"),tipKey:c("tip"),customPopupClass:c(""),customPopupStyle:c("")}),le=G(f(i(u({},{name:"wd-drop-menu-item",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:ae,emits:["update:modelValue","change","open","opened","close","closed"],setup(e,{expose:o,emit:t}){const a=e,l=t,s=w(Z,null),n=y(!1),u=y(!1),i=y(),r=y(12),d=y(0),{parent:c}=Y(oe),{proxy:p}=b(),m=_(()=>{let e="";return e=n.value&&c?"down"===c.props.direction?`top: calc(var(--window-top) + ${c.offset.value}px); bottom: 0;`:`top: 0; bottom: calc(var(--window-bottom) + ${c.offset.value}px)`:"",e});function v(){u.value&&(L(a.beforeToggle)?a.beforeToggle({status:!1,resolve:e=>{e&&f()}}):f())}function f(){u.value&&(u.value=!1)}function G(){u.value||(L(a.beforeToggle)?a.beforeToggle({status:!0,resolve:e=>{e&&M()}}):M())}function M(){n.value=!0,u.value=!0,c&&(d.value=Number(c.props.duration),i.value="down"===c.props.direction?"top":"bottom")}function U(){n.value=!1,l("closed")}function A(){l("open")}function D(){l("opened")}function q(){l("close")}return g(()=>a.modelValue,e=>{B(e)&&"number"!=typeof e&&"string"!=typeof e&&console.error("[wot-design] warning(wd-drop-menu-item): the type of value should be a number or a string.")},{deep:!0,immediate:!0}),h(()=>{var e;s&&s.pushToQueue?s.pushToQueue(p):(e=p,ee.push(e))}),$(()=>{var e;s&&s.removeFromQueue?s.removeFromQueue(p):(e=p,ee=ee.filter(o=>o.$.uid!==e.$.uid))}),o({getShowPop:function(){return u.value},open:G,close:v,toggle:function(){u.value?v():G()}}),(e,o)=>{const t=E,s=T;return n.value?(C(),x(s,{key:0,class:j(`wd-drop-item  ${e.customClass}`),style:H(`pointer-events: none; z-index: ${r.value}; ${m.value};${e.customStyle}`)},{default:K(()=>[O(P,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e),"z-index":r.value,duration:d.value,position:i.value,"custom-style":`position: absolute; pointer-events: auto; max-height: 80%;${e.customPopupStyle}`,"custom-class":e.customPopupClass,modal:!1,"close-on-click-modal":!1,onBeforeEnter:A,onAfterEnter:D,onBeforeLeave:q,onAfterLeave:U},{default:K(()=>[e.options.length?(C(),x(s,{key:0},{default:K(()=>[(C(!0),z(I,null,V(e.options,(o,n)=>(C(),x(s,{key:n,onClick:e=>function(e){if(a.disabled)return;const{valueKey:o}=a,t=a.options[e],s=void 0!==t[o]?t[o]:t;l("update:modelValue",s),l("change",{value:s,selectedItem:t}),v()}(n),class:j("wd-drop-item__option "+((""!==o[e.valueKey]?o[e.valueKey]:o)===e.modelValue?"is-active":""))},{default:K(()=>[O(s,{class:j(`wd-drop-item__title ${e.customTitle}`)},{default:K(()=>[O(t,null,{default:K(()=>[N(Q(o[e.labelKey]?o[e.labelKey]:o),1)]),_:2},1024),o[e.tipKey]?(C(),x(t,{key:0,class:"wd-drop-item__tip"},{default:K(()=>[N(Q(o[e.tipKey]),1)]),_:2},1024)):k("",!0)]),_:2},1032,["class"]),(""!==o[e.valueKey]?o[e.valueKey]:o)===e.modelValue?(C(),x(F,{key:0,name:e.iconName,"custom-class":`wd-drop-item__icon ${e.customIcon}`},null,8,["name","custom-class"])):k("",!0)]),_:2},1032,["onClick","class"]))),128))]),_:1})):S(e.$slots,"default",{key:1},void 0,!0)]),_:3},8,["modelValue","z-index","duration","position","custom-style","custom-class"])]),_:3},8,["class","style"])):k("",!0)}}})),[["__scopeId","data-v-a0484388"]]),se=G(f(i(u({},{name:"wd-drop-menu",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:te,setup(e){const o=e,t=w(Z,null),a=y(`dropMenuId${M()}`),l=y(0),s=y(0),n=_(()=>"down"===o.direction?`top: calc(var(--window-top) + ${l.value}px); bottom: 0;`:`top: 0; bottom: calc(var(--window-bottom) + ${l.value}px)`),{proxy:u}=b(),{linkChildren:i,children:r}=W(oe),d=_(()=>r.some(e=>e.$.exposed.getShowPop())),c=y(!1);let p;function m(){}function v(e){const{title:o,modelValue:t,options:a,valueKey:l,labelKey:s}=e;if(o)return o;for(let n=0,u=a.length;n<u;n++)if(t===a[n][l])return a[n][s];console.error("[wot-design] warning(wd-drop-menu-item): no value is matched in the options option.")}function f(e){var o;e&&!e.disabled&&(t&&t.closeOther?t.closeOther(e):(o=e,ee.forEach(e=>{e.$.uid!==o.$.uid&&e.$.exposed.close()})),$(e))}function $(e){A(`#${a.value}`,!1,u).then(t=>{if(!t)return;const{top:a,bottom:n}=t;"down"===o.direction?l.value=Number(n):l.value=s.value-Number(a),e.$.exposed.toggle()})}function P(){o.closeOnClickModal&&r.forEach(e=>{e.$.exposed.close()})}return g(d,e=>{p&&clearTimeout(p),e?c.value=!0:p=setTimeout(()=>{c.value=!1,p=null},16)}),i({props:o,fold:$,offset:l}),g(()=>o.direction,e=>{["up","down"].includes(e)||console.error("[wot ui] warning(wd-drop-menu): direction must be 'up' or 'down'")},{deep:!0,immediate:!0}),h(()=>{s.value=U().windowHeight}),(e,o)=>{const t=T,l=D(q("wd-icon"),F);return C(),x(t,{style:H(e.customStyle),class:j(`wd-drop-menu ${e.customClass}`),onClick:X(m,["stop","prevent"]),id:a.value},{default:K(()=>[e.modal?(C(),x(J,{key:0,show:c.value,duration:e.duration,"z-index":12,"custom-style":n.value,onClick:P,onTouchmove:m},null,8,["show","duration","custom-style"])):k("",!0),O(t,{class:"wd-drop-menu__list"},{default:K(()=>[(C(!0),z(I,null,V(R(r),(e,o)=>(C(),x(t,{key:o,onClick:o=>f(e),class:j(`wd-drop-menu__item ${e.disabled?"is-disabled":""} ${e.$.exposed.getShowPop()?"is-active":""}`)},{default:K(()=>[O(t,{class:"wd-drop-menu__item-title"},{default:K(()=>[O(t,{class:"wd-drop-menu__item-title-text"},{default:K(()=>[N(Q(v(e)),1)]),_:2},1024),O(l,{name:e.icon,size:e.iconSize,"custom-class":"wd-drop-menu__arrow"},null,8,["name","size"])]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1}),S(e.$slots,"default",{},void 0,!0)]),_:3},8,["style","class","id"])}}})),[["__scopeId","data-v-b41e9b4f"]]);export{le as _,se as a};
//# sourceMappingURL=wd-drop-menu.DNC_Ilmj.js.map
